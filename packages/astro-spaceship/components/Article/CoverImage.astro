---
import { getImage, Image } from 'astro:assets';

export type Props = {
  class?: string;
  style?: string;
  cover?: ImageMetadata | undefined;
  'cover-x'?: number | undefined;
  'cover-y'?: number | undefined;
}

const { class: className, style, cover, 'cover-x': coverX, 'cover-y': coverY } = Astro.props;

const coverImage = cover ? (await getImage({
  src: cover,
  inferSize: true,
  format: 'webp',
  quality: 'high',
})) : undefined;

---
{
  coverImage && (
    <figure class:list={["article-cover", className]} style={style}>
      <Image
        src={coverImage.src}
        height={coverImage.attributes.height}
        width={coverImage.attributes.width}
        alt=""
        class:list={["article-cover-image", coverX || coverY ? `` : "article-cover-center"]}
        style={
          coverX || coverY ? `object-position: ${coverX}% ${coverY}%;` : ""
        }
      />
      <slot name="figcaption"></slot>
    </figure>
  )
}